import{_ as w}from"./DZMaSFZu.js";import{_ as A}from"./DwqDLC2w.js";import{_ as v}from"./BlGS-IPB.js";import{h as R,a7 as $,J as k,C,D as j,G as T,a2 as V,L as _,o as B,v as I,w as o,b as s,a as m,I as i,j as L}from"./B9LE8NEz.js";import{_ as F}from"./C2zDVeAx.js";import{_ as Y}from"./DRkbGMpv.js";import{_ as G}from"./B9Ro5hOh.js";import{$ as p}from"./DI6bnUVi.js";import{z as f}from"./DXqQCM1T.js";import{A as u}from"./C7p56BG2.js";import"./tCEg_WaZ.js";import"./vfiB1am4.js";import"./DpjbJNLR.js";const N=m("h2",{class:"text-xl font-semibold"},"Request Account Delete",-1),O={class:"flex justify-end"},P=m("div",{class:"w-full max-w-[500px] mt-4 text-center text-gray-500"}," You also can delete account via dashboard, login and go to profile page. ",-1),se=R({__name:"request-delete",setup(S){const n=$(),c=k(),d=C(),h=j(),l=T({email:""}),g=f.object({email:f.string().email("Invalid email address")}),x=async()=>{var a;n.start();try{const e=await p(u.User.RequestDelete.url(),{method:"DELETE",body:u.User.RequestDelete.parseData(l.value)});console.log(e),c.add({title:"Account Delete Requested",description:"Your request has been sent to your email, please check your email to confirm.",color:"green"}),setTimeout(()=>{d.signOut({callbackUrl:"/",redirect:!0})},2e3)}catch(e){console.error(e);let t="An error occurred while deleting your account, please try again later.";e instanceof _&&(t=((a=e.data)==null?void 0:a.message)||t),c.add({title:"Error",description:t,color:"red"})}n.finish()};return V(async()=>{var e;const a=h.query;if(a.code){n.start();try{const t=await p(u.User.RequestDelete.url(),{method:"DELETE",body:u.User.RequestDelete.parseData({code:a.code})});console.log(t),c.add({title:"Account Deleted",description:"Your account has been deleted successfully, logging you out.",color:"green"}),setTimeout(()=>{d.signOut({callbackUrl:"/",redirect:!0})},3e3)}catch(t){console.error(t);let r="An error occurred while deleting your account, please try again later.";t instanceof _&&(r=((e=t.data)==null?void 0:e.message)||r),c.add({title:"Error",description:r,color:"red"})}n.finish()}}),(a,e)=>{const t=w,r=A,y=v,b=L,q=F,D=Y,U=G;return B(),I(U,{class:"flex-1 flex flex-col gap-4 justify-center"},{default:o(()=>[s(D,{class:"flex flex-col items-center justify-center"},{default:o(()=>[s(q,{class:"w-full max-w-[500px]"},{header:o(()=>[N]),footer:o(()=>[m("div",O,[s(b,{variant:"solid",color:"primary",label:"Send Request to Email",onClick:x})])]),default:o(()=>[s(y,{schema:i(g),state:i(l),class:"flex flex-col gap-4"},{default:o(()=>[s(r,{label:"Email",name:"email",required:""},{default:o(()=>[s(t,{modelValue:i(l).email,"onUpdate:modelValue":e[0]||(e[0]=E=>i(l).email=E),type:"email",placeholder:"you@example.com",icon:"i-heroicons-envelope"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),_:1}),P]),_:1})]),_:1})}}});export{se as default};
