import{_ as w,a as A}from"./4-_aeM40.js";import{_ as $}from"./IDi5nSnl.js";import{h as R,a7 as k,L as v,D as C,E as T,P as V,a0 as j,ap as _,o as B,x as L,w as o,b as s,a as m,H as i,k as F}from"./C2VZCrLL.js";import{_ as I}from"./EnXXcHgJ.js";import{_ as P}from"./bGGhZPT_.js";import{_ as Y}from"./CjKnBnRE.js";import{$ as p}from"./B1L_3MPY.js";import{z as f}from"./dIKOytT1.js";import{A as u}from"./BUTGLEXC.js";import"./CqmuLGFh.js";import"./mVLOGpJV.js";import"./YBhKZdnL.js";const N=m("h2",{class:"text-xl font-semibold"},"Request Account Delete",-1),O={class:"flex justify-end"},S=m("div",{class:"w-full max-w-[500px] mt-4 text-center text-gray-500"}," You also can delete account via dashboard, login and go to profile page. ",-1),ae=R({__name:"request-delete",setup(z){const n=k(),c=v(),d=C(),h=T(),l=V({email:""}),g=f.object({email:f.string().email("Invalid email address")}),x=async()=>{var a;n.start();try{const e=await p(u.User.RequestDelete.url(),{method:"DELETE",body:u.User.RequestDelete.parseData(l.value)});console.log(e),c.add({title:"Account Delete Requested",description:"Your request has been sent to your email, please check your email to confirm.",color:"green"}),setTimeout(()=>{d.signOut({callbackUrl:"/",redirect:!0})},2e3)}catch(e){console.error(e);let t="An error occurred while deleting your account, please try again later.";e instanceof _&&(t=((a=e.data)==null?void 0:a.message)||t),c.add({title:"Error",description:t,color:"red"})}n.finish()};return j(async()=>{var e;const a=h.query;if(a.code){n.start();try{const t=await p(u.User.RequestDelete.url(),{method:"DELETE",body:u.User.RequestDelete.parseData({code:a.code})});console.log(t),c.add({title:"Account Deleted",description:"Your account has been deleted successfully, logging you out.",color:"green"}),setTimeout(()=>{d.signOut({callbackUrl:"/",redirect:!0})},3e3)}catch(t){console.error(t);let r="An error occurred while deleting your account, please try again later.";t instanceof _&&(r=((e=t.data)==null?void 0:e.message)||r),c.add({title:"Error",description:r,color:"red"})}n.finish()}}),(a,e)=>{const t=w,r=A,y=$,b=F,q=I,D=P,E=Y;return B(),L(E,{class:"flex-1 flex flex-col gap-4 justify-center"},{default:o(()=>[s(D,{class:"flex flex-col items-center justify-center"},{default:o(()=>[s(q,{class:"w-full max-w-[500px]"},{header:o(()=>[N]),footer:o(()=>[m("div",O,[s(b,{variant:"solid",color:"primary",label:"Send Request to Email",onClick:x})])]),default:o(()=>[s(y,{schema:i(g),state:i(l),class:"flex flex-col gap-4"},{default:o(()=>[s(r,{label:"Email",name:"email",required:""},{default:o(()=>[s(t,{modelValue:i(l).email,"onUpdate:modelValue":e[0]||(e[0]=U=>i(l).email=U),type:"email",placeholder:"you@example.com",icon:"i-heroicons-envelope"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),_:1}),S]),_:1})]),_:1})}}});export{ae as default};
