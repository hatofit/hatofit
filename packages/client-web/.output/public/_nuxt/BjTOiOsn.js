import{_ as w}from"./CQlPFy4X.js";import{_ as A}from"./Cxw5_Ya5.js";import{_ as $}from"./4x2wAUPl.js";import{h as R,a7 as k,M as v,D as C,E as T,H as V,a0 as j,O as _,o as B,x as I,w as o,b as s,a as m,I as i,k as F}from"./BqiWrrJw.js";import{_ as L}from"./ulwWl0-q.js";import{_ as O}from"./KxBifYFB.js";import{_ as Y}from"./BFCeLwYc.js";import{$ as p}from"./CTQoGjjg.js";import{z as f}from"./DXqQCM1T.js";import{A as u}from"./CxOUCrNJ.js";import"./Cb9RPHSR.js";import"./DqNYuvwW.js";import"./Doeqeqsn.js";const M=m("h2",{class:"text-xl font-semibold"},"Request Account Delete",-1),N={class:"flex justify-end"},P=m("div",{class:"w-full max-w-[500px] mt-4 text-center text-gray-500"}," You also can delete account via dashboard, login and go to profile page. ",-1),se=R({__name:"request-delete",setup(S){const n=k(),c=v(),d=C(),h=T(),l=V({email:""}),g=f.object({email:f.string().email("Invalid email address")}),x=async()=>{var a;n.start();try{const e=await p(u.User.RequestDelete.url(),{method:"DELETE",body:u.User.RequestDelete.parseData(l.value)});console.log(e),c.add({title:"Account Delete Requested",description:"Your request has been sent to your email, please check your email to confirm.",color:"green"}),setTimeout(()=>{d.signOut({callbackUrl:"/",redirect:!0})},2e3)}catch(e){console.error(e);let t="An error occurred while deleting your account, please try again later.";e instanceof _&&(t=((a=e.data)==null?void 0:a.message)||t),c.add({title:"Error",description:t,color:"red"})}n.finish()};return j(async()=>{var e;const a=h.query;if(a.code){n.start();try{const t=await p(u.User.RequestDelete.url(),{method:"DELETE",body:u.User.RequestDelete.parseData({code:a.code})});console.log(t),c.add({title:"Account Deleted",description:"Your account has been deleted successfully, logging you out.",color:"green"}),setTimeout(()=>{d.signOut({callbackUrl:"/",redirect:!0})},3e3)}catch(t){console.error(t);let r="An error occurred while deleting your account, please try again later.";t instanceof _&&(r=((e=t.data)==null?void 0:e.message)||r),c.add({title:"Error",description:r,color:"red"})}n.finish()}}),(a,e)=>{const t=w,r=A,y=$,b=F,q=L,D=O,E=Y;return B(),I(E,{class:"flex-1 flex flex-col gap-4 justify-center"},{default:o(()=>[s(D,{class:"flex flex-col items-center justify-center"},{default:o(()=>[s(q,{class:"w-full max-w-[500px]"},{header:o(()=>[M]),footer:o(()=>[m("div",N,[s(b,{variant:"solid",color:"primary",label:"Send Request to Email",onClick:x})])]),default:o(()=>[s(y,{schema:i(g),state:i(l),class:"flex flex-col gap-4"},{default:o(()=>[s(r,{label:"Email",name:"email",required:""},{default:o(()=>[s(t,{modelValue:i(l).email,"onUpdate:modelValue":e[0]||(e[0]=U=>i(l).email=U),type:"email",placeholder:"you@example.com",icon:"i-heroicons-envelope"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),_:1}),P]),_:1})]),_:1})}}});export{se as default};
